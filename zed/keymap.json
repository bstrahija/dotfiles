[
    // Global
    {
        "context": "Workspace",
        "bindings": {
            "shift shift": "file_finder::Toggle",
            "ctrl-f": ["projects::OpenRecent", { "create_new_window": false }],
            "cmd-e": "project_panel::ToggleFocus",
            "alt-cmd-p": ["projects::OpenRecent", { "create_new_window": false }],
            "ctrl-g ctrl-g": "git_panel::ToggleFocus",
            "ctrl-x ctrl-x": "agent::ToggleFocus"
        }
    },

    {
        "context": "EmptyPane || SharedScreen || vim_operator == none && !VimWaiting && vim_mode != insert",
        "bindings": {
            "space space": "file_finder::Toggle",
            "space s s": "zed::OpenSettingsFile",
            "space s k": "zed::OpenKeymapFile",
            "space w": "workspace::Save",
            "space q q": "pane::CloseActiveItem",
            "space q o": "pane::CloseOtherItems",
            "space Q": "workspace::CloseWindow",
            "space l": "language_selector::Toggle",
            "space s t": "theme_selector::Toggle",
            "space s i": "icon_theme_selector::Toggle",
            "space g g": "git_panel::ToggleFocus",
            "space g b": "git::Blame",
            "space g i": "editor::ToggleGitBlameInline",
            "space f": "editor::ToggleFold",
            "space F F": "editor::FoldAll",
            "space F U": "editor::UnfoldAll",
            "space e e": "diagnostics::Deploy",
            "space e ]": "editor::GoToDiagnostic",
            "space e [": "editor::GoToPreviousDiagnostic",
            "space z": "workspace::ToggleZoom",
            "space c": "vim::ToggleComments",
            "space a": "pane::AlternateFile",
            "space b b": "pane::AlternateFile",
            "space b n": "pane::ActivateNextItem",
            "space b p": "pane::ActivatePreviousItem",
            "space \\": "pane::SplitAndMoveRight",
            "space -": "pane::SplitAndMoveDown",
            "space t t": "tab_switcher::Toggle",
            "space t g": "editor::ToggleTabBar",
            "g i": "editor::GoToImplementation",
            "g o": "outline_panel::ToggleFocus",
            "g a": "editor::ToggleCodeActions",
            "g =": "editor::Format",
            "g m": "vim::Matching",
            "g l": "editor::OpenSelectedFilename",
            "space p": ["projects::OpenRecent", { "create_new_window": false }],
            "cmd-alt-j": ["editor::AddSelectionBelow", { "skip_soft_wrap": true }],
            "cmd-alt-k": ["editor::AddSelectionAbove", { "skip_soft_wrap": true }],
            "ctrl-f": ["projects::OpenRecent", { "create_new_window": false }]
        }
    },

    // Vim sneak
    {
        "context": "Editor && vim_mode == normal",
        "bindings": {
            "s": "vim::PushSneak",
            "S": "vim::PushSneakBackward"
        }
    },

    // Line stuff
    {
        "context": "Editor && (vim_mode == normal || vim_mode == insert)",
        "bindings": {
            "shift-enter": "editor::NewlineBelow",
            "ctrl-shift-enter": "editor::NewlineAbove",
            "alt-h": "vim::StartOfLineDownward",
            "H": "vim::StartOfLineDownward",
            "alt-l": "vim::EndOfLineDownward",
            "L": "vim::EndOfLineDownward"
        }
    },
    {
        "context": "Editor && vim_mode == insert",
        "bindings": {
            "j j": "vim::NormalBefore"
        }
    },
    {
        "context": "Editor && (vim_mode == visual || vim_mode == insert)",
        "bindings": {
            "alt-w": "editor::WrapSelectionsInTag"
        }
    },
    {
        "context": "(Editor && mode == full)",
        "bindings": {
            "cmd-e": "project_panel::ToggleFocus"
        }
    },
    {
        "context": "Editor",
        "bindings": {
            "ctrl-n": ["editor::SelectNext", { "replace_newest": false }],
            "ctrl-/": "vim::ToggleComments",
            "alt-j": "editor::MoveLineDown",
            "alt-k": "editor::MoveLineUp",
            "ctrl-]": "pane::ActivateNextItem",
            "ctrl-[": "pane::ActivatePreviousItem"
        }
    },

    // Manage files in project panel ()
    {
        "context": "ProjectPanel && not_editing",
        "bindings": {
            "a": "project_panel::NewFile",
            "A": "project_panel::NewDirectory",
            "p": "project_panel::Paste",
            "x": "project_panel::Cut",
            "s": "project_panel::Open",
            "c": "project_panel::Copy",
            "r": "project_panel::Rename",
            "d": "project_panel::Trash",
            "l": "project_panel::Open",
            "shift-d": "project_panel::Delete"
        }
    },

    // Markdown
    {
        "context": "Editor && (vim_mode == normal || vim_mode == visual) && vim_operator == none && !VimWaiting",
        "bindings": {
            "space m p": "markdown::OpenPreview",
            "space m P": "markdown::OpenPreviewToTheSide"
        }
    },

    // Empty screen
    {
        "context": "EmptyPane || SharedScreen",
        "bindings": {
            "space f": "file_finder::Toggle",
            "space space": "file_finder::Toggle",
            "shift-shift": "file_finder::Toggle"
        }
    },

    // AI
    // 1. Accept AI suggestion with Ctrl-Y (non-conflict context)
    {
        "context": "Editor && edit_prediction",
        "bindings": {
            "ctrl-y": "editor::AcceptEditPrediction"
        }
    },

    // 2. Accept AI suggestion with Ctrl-Y (conflict context - when LSP menu is also visible)
    {
        "context": "Editor && edit_prediction_conflict",
        "bindings": {
            "ctrl-y": "editor::AcceptEditPrediction"
        }
    },

    // 3. Prevent TAB from accepting the suggestion (restores normal indent)
    // This must be a specific override to beat the default binding.
    {
        "context": "Editor && edit_prediction",
        "bindings": {
            "tab": "editor::Tab"
        }
    },

    // 4. Prevent TAB from accepting the suggestion in the conflict context
    {
        "context": "Editor && edit_prediction_conflict",
        "bindings": {
            "tab": "editor::Tab"
        }
    }
]
